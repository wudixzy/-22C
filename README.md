根据您提供的论文内容，整体算法思路可以分为几个主要部分，包括动量交易、均值回归、卖出策略、极端市场条件应对、无买入条件、资产持有期、每日买卖决策及噪声归一化等。以下是整体算法思路的总结和相关公式：

论文中计算买入信号，是直接将当日价格与前一天价格相减计算梯度，当日价格减去有权重的移动平均并且看差值的大小（不是看波动的百分比）。有一点抽象。

### 1. **动量交易 (Momentum Trading)**

动量交易策略的核心是利用资产价格的梯度和移动平均来决定是否买入或卖出资产。

- **价格梯度计算**：
  $$
  G_t(n) = P_t - P_{t-n+1}
  $$
  其中，$P_t$ 是时间 $t$ 时的资产价格，$n$ 是观察的时间区间。

- **移动平均计算**：
  $$
  A_t(n) = \frac{\sum_{i=0}^{n-1} w_i P_{t-i}}{\sum_{i=0}^{n-1} w_i}
  $$
  其中，$w_i$ 是给定价格的权重，$n$ 是时间窗口大小。

- **买入/卖出信号决策**：
  $$
  M_t(n) = 
  \begin{cases} 
  1 & \text{if } G_t(n) > 1 \text{ and } P_t - A_t(n) > 1 \\
  -1 & \text{otherwise}
  \end{cases}
  $$
  如果动量和价格偏离度都大于某个阈值，则发出买入信号（$M_t(n) > 1$），否则发出卖出信号。

### 2. **均值回归 (Reversion to Mean)**

均值回归策略基于价格偏离移动平均的程度来判断资产价格是否会回归到均值。

- **回归到均值的条件**：
  $$
  \int_{\mu-i}^{\mu+i} P(x)dx > \int_{\mu-j}^{\mu+j} P(x)dx \quad \text{对于} \quad i > j > 0
  $$
  其中，$\mu$ 是价格的移动平均，$P(x)$ 是资产价格。

- 如果资产价格偏离均值较大，模型认为价格可能会回归到均值，从而发出买入信号。

### 3. **盈利性计算 (Profitability Calculation)**

每个交易信号都带有一个“盈利性”指标，用来判断该交易是否具有潜在的利润。

- **动量交易的盈利性**：
  动量交易的盈利性与价格梯度成正比。高梯度意味着趋势持续时间长，利润更大。

- **均值回归的盈利性**：
  与价格偏离均值的平方成正比。价格偏离均值越大，未来回归的可能性越高，买入信号的盈利性也就越大。

### 4. **卖出策略 (Selling Strategy)**

卖出决策基于资产当前价格和历史平均价格的对比，并考虑交易费用。

- **卖出条件**：
  $$
  S = (1 - f_a) \cdot P - \sum_{i=0}^{n} (1 - f_{ai}) C_i - L
  $$
  其中，$f_a$ 是交易费率，$P$ 是当前资产价格，$C_i$ 是历史购买成本，$L$ 是一个最小利润门槛。如果 $S > 0$，则执行卖出。

### 5. **极端市场条件 (Extreme Market Conditions)**

当市场价格的变化过于剧烈时，进入极端市场条件，这时不允许卖出资产，直到价格回归到某个范围。

- **极端市场条件触发**：
  $$
  E = G_t(n) - C \cdot \frac{\sum_{i=0}^{n} G_t(i)}{n}
  $$
  其中，$C$ 是一个缩放因子，$E > 0$ 时，价格变化剧烈，激活极端市场条件。如果触发条件成立，模型会延迟卖出，直到价格回归至最大值的某个百分比范围或下降至最大值以下。

### 6. **无买入条件 (No-Buy Condition)**

在经历极端市场条件和卖出操作后，模型禁止在接下来的几天内再次买入，以避免在价格回升时过早再进入市场。

### 7. **资产持有期 (Holding Assets)**

为了避免频繁交易并减少手续费的影响，模型设定了一个资产持有期。在持有期内，即使市场价格发生变化，模型也不会立即卖出。

### 8. **每日买卖决策 (Daily Buy/Sell Order)**

模型每天检查市场价格，并根据以下优先级做出决策：
1. 检查是否满足“无买入”条件和极端市场条件。
2. 如果没有激活任何特殊条件，模型会根据卖出信号进行卖出操作。
3. 如果极端市场条件被激活，模型会采取相应的极端市场应对逻辑。
4. 最后，模型根据买入信号决定是否进行买入操作。

### 9. **噪声归一化 (Noise Normalization)**

由于比特币和黄金等资产的波动幅度不同，模型引入了一个加权因子来减少小幅度价格变化的影响。

- **噪声归一化因子**：
  $$
  W = \frac{C}{t^2}
  $$
  其中，$t$ 是时间（天数），$C$ 是常数。随着时间增加，权重因子变小，从而减少小波动的影响，模型更加关注大波动。

### 总结

这篇论文的算法通过动量交易、均值回归、卖出策略、极端市场条件应对等策略，结合噪声归一化和资产持有期，构建了一个适应比特币和黄金市场波动的反应式交易模型。通过每天的市场数据更新，模型能够动态决定买入、卖出或持有资产，最大化利润，同时避免过早或过晚的交易决策。
